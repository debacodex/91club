import{G as $e,z as Te,r as g,R as Pe,T as xe,A as X,B as V,a9 as Se,$ as Ie,aN as Ue,a8 as Le,C as De,aJ as Ne,H as _,I as c,Q as r,au as p,J as e,aA as w,P as o,O as m,K as Y,M as ee,an as f,ao as E,V as Ve,aB as Re,aC as Be,u as O,F as te,N as d,at as Ee,aw as Oe,aE as Fe}from"./common.modules-6670d68a.js";import{ak as Me,al as Ae,am as qe,an as We,ao as ze,at as Ze,aq as ae,L as F,ar as oe,ae as Qe,as as He,au as Je}from"./page-activity-ActivityDetail-88cfafe3.js";import{u as Ke}from"./page-arupi-arupi_v2-d9ed44a6.js";const k=P=>(Re("data-v-7afe3ff2"),P=P(),Be(),P),Ge={class:"x-order pt10 pr15 pl15"},je={key:0},Xe={class:"order_info"},Ye={class:"item"},et={class:"amount"},tt={class:"amount-copy"},at={class:"timeout"},ot={key:0},st={class:"x-title"},nt=k(()=>e("span",null,null,-1)),it={class:"x-order-pay x-row x-flex-warp"},lt=["onClick"],rt={class:"x-row x-row-middle-center"},dt=["src"],ct={class:"name"},ut={key:0},pt={class:"x-title"},mt=k(()=>e("span",null,null,-1)),vt={class:"qrcode mb8"},ft={class:"qrimg"},ht={key:0,class:"utr-copy"},yt={class:"x-tc mt8"},_t={class:"x-tc mt8 mb16"},wt={class:"x-title"},gt=k(()=>e("span",null,null,-1)),kt={class:"x-order-utr"},Ct={class:"box"},bt={class:"x-title mt8"},$t=k(()=>e("span",null,null,-1)),Tt={class:"transfro_tip"},Pt={key:1},xt={class:"order_info"},St={class:"item"},It={class:"amount"},Ut={class:"amount-copy"},Lt={class:"timeout"},Dt={class:"x-order-utr"},Nt={class:"box"},Vt={key:2,class:"x-order-food"},Rt={key:3,class:"x-row x-column x-row-middle x-tc expired"},Bt=k(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"72",viewBox:"0 0 72 72",fill:"none"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M36 6.96774C19.9659 6.96774 6.96774 19.9659 6.96774 36C6.96774 52.0341 19.9659 65.0323 36 65.0323C52.0341 65.0323 65.0323 52.0341 65.0323 36C65.0323 19.9659 52.0341 6.96774 36 6.96774ZM0 36C0 16.1177 16.1177 0 36 0C55.8822 0 72 16.1177 72 36C72 55.8822 55.8822 72 36 72C16.1177 72 0 55.8822 0 36ZM36 40.9268L23.6834 53.2435L18.7564 48.3165L31.0731 35.9999L18.7565 23.6834L23.6835 18.7564L36 31.073L48.3165 18.7564L53.2435 23.6834L40.9269 35.9999L53.2436 48.3165L48.3166 53.2435L36 40.9268Z",fill:"var(--main-color)"})],-1)),Et={class:"mt16 txt"},Ot={key:4,class:"x-row x-column x-row-middle x-tc submit-complete"},Ft=k(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"72",viewBox:"0 0 72 72",fill:"none"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M36 6.96774C19.9659 6.96774 6.96774 19.9659 6.96774 36C6.96774 52.0341 19.9659 65.0323 36 65.0323C52.0341 65.0323 65.0323 52.0341 65.0323 36C65.0323 19.9659 52.0341 6.96774 36 6.96774ZM0 36C0 16.1177 16.1177 0 36 0C55.8822 0 72 16.1177 72 36C72 55.8822 55.8822 72 36 72C16.1177 72 0 55.8822 0 36Z",fill:"#F6B02C"}),e("path",{d:"M48.5108 48.7305L35.1348 37V16",stroke:"#F6B02C","stroke-width":"7"})],-1)),Mt={class:"weight"},At={class:"x-order-reason pr16 pb16 pl16 pt16"},qt={class:"title mb16 x-row x-row-middle-center"},Wt={class:"pl25 mt10"},zt=["placeholder"],Zt={class:"arupi"},Qt={class:"title1"},Ht={class:"title2"},Jt={class:"arupi"},Kt={class:"title1"},Gt={class:"title2"},jt={class:"button"},aa=$e({__name:"index",setup(P){const{t:x}=Te(),C=g(!1),S=Pe(),se=xe(),{handleOpen:M}=Me({type:3}),{startFun:A,stopFun:ne,pageData:q}=Ae(),{pageView:ie,pageLeve:le,pageClick:W}=qe(),I=g(!1),R=g(3),b=g(),h=X({checked:-1,text:""}),$=g(!1),U=g([]),re=t=>{t.target.value&&(h.checked=-1)},de=t=>{t>-1&&(h.text="")},z=async()=>{var t,a,i,l;if(navigator.clipboard&&navigator.clipboard.readText)try{const v=await navigator.clipboard.readText();u.value=v||""}catch{u.value=((a=(t=document==null?void 0:document.getSelection)==null?void 0:t.call(document))==null?void 0:a.toString())??""}else u.value=((l=(i=document==null?void 0:document.getSelection)==null?void 0:i.call(document))==null?void 0:l.toString())??""},Z=V(()=>[{name:"Paytm",icon:"icon/Paytm",id:1,url:"paytmmp://cash_wallet",desc:"Wake up support"},{name:"PhonePe",icon:"icon/PhonePe",id:2,url:"phonepe://pay",desc:s.info.isPhonepeWakeUp===1?"Wake up support":"Pay for oneself"}]),y=g(),Q=Se(""),ce=Ke(Q,{margin:0,width:145,errorCorrectionLevel:"H",quality:1}),s=X({info:{merchantCode:"",merchantName:"",paymentExpireTime:0,amount:0,merchantOrder:"",platformOrder:"",buyOrderNo:"",sellOrderNo:"",chOrderNo:"",createTime:"",memberId:"",externalMemberId:"",returnUrl:"",orderStatus:"",upiId:"",utr:"",hideUpiCopyButton:1,randomCode:"",isPhonepeWakeUp:0},type:0}),ue=V(()=>s.info.utr?s.info.utr:q.info.utr),T=V(()=>!!(s.info.utr||q.info.utr)),u=g("");Ie(ue,t=>{u.value=t});const{pause:pe,resume:me}=Ue(()=>{s.info.paymentExpireTime<=0?(H(),ne(),pe()):s.info.paymentExpireTime-=1},1e3,{immediate:!1,immediateCallback:!1}),ve=async()=>{const{code:t,data:a}=await We({});t==="1"&&(U.value=a)},H=async()=>{const t=se.query.type,{code:a,data:i}=await ze();a==="1"?(s.type=t?4:0,s.info=i,i.orderStatus==="2"?S.replace("/Payment"):i.orderStatus==="3"&&S.replace("/Fail"),await Ve(),Q.value="upi://pay?pa="+i.upiId+"&am="+i.amount+"&cu=INR&tn="+i.tid+"&notes="+i.tid+"&transactionDescription="+i.tid+"&tid="+i.tid+"&tr="+i.tid,me(),A("",0),A("",1)):(s.type=1,C.value=!1)},fe=()=>{s.type=4,$.value=!1};function he(){const{amount:t,upiId:a,tid:i}=s.info;try{const l={contact:{type:"VPA",vpa:a,cbsName:"",nickName:""},p2pPaymentCheckoutParams:{checkoutType:"DEFAULT",initialAmount:t*100,note:i,currency:"INR",transactionContext:"p2p",isByDefaultKnownContact:!0,disableViewHistory:!0,shouldShowMaskedNumber:!0,shouldShowUnsavedContactBanner:!1,showKeyboard:!0,allowAmountEdit:!1,disableNotesEdit:!0,showQrCodeOption:!1,enableSpeechToText:!1,isRecurring:!1}},v=btoa(JSON.stringify(l));Je();const B=`phonepe://native?data=${v}&id=p2ppayment`;window.location.href=B}catch(l){console.error("PhonePe Deeplink 测试出错:",l)}}const J=t=>{var i,l,v;let a=t.url;y.value=t.name,t.url.startsWith("paytmmp://cash_wallet")?(a+=`?featuretype=money_transfer&pa=${s.info.upiId}&am=${s.info.amount}&cu=INR&tn=${((i=s.info)==null?void 0:i.tid)||""}&tid=${(l=s.info)==null?void 0:l.tid}&tr=${(v=s.info)==null?void 0:v.tid}`,window.open(a,"_blank"),W(1)):(s.info.isPhonepeWakeUp===1&&he(),W(2))},ye=()=>{I.value=!0,clearInterval(b.value),b.value=null,R.value=3,b.value=setInterval(()=>{R.value-=1},1e3),setTimeout(()=>{clearInterval(b.value),b.value=null,I.value=!1,J(Z.value[0])},3e3)},K=Le(async()=>{if(T.value)return;if(!u.value||u.value.length<12)return O(x("formatIncorrect"));const t=await Ze({utr:u.value});t.code==="1"?(s.type=3,te(x("SubmittedS")),setTimeout(()=>{L()},1e3)):O(t.msg)},3e3),_e=async()=>{var l,v;const{checked:t,text:a}=h;if(t===-1&&!a)return O(x("addCancelDes"));(await He({reason:t>-1?(l=U.value[t])==null?void 0:l.reason:h.text,reasonId:t>-1?(v=U.value[t])==null?void 0:v.id:null})).code==="1"&&(C.value=!1,te(x("cancelSuccess")),setTimeout(()=>{S.push({name:"Recharge"})},1e3))},we=t=>{const[a,i]=t.split("@");return"*".repeat(a.length)+"@"+i},ge=V(()=>s.info.amount<2e3?!1:s.info.hideUpiCopyButton==0);function L(){S.push({name:"Recharge"})}return De(()=>{H(),ve(),setTimeout(()=>{ie("order")},1500)}),Ne(()=>{le("order")}),(t,a)=>{const i=_("NavBar"),l=_("svg-icon"),v=_("van-loading"),B=_("van-image"),D=_("van-button"),G=_("van-field"),ke=_("van-radio"),Ce=_("van-radio-group"),be=_("van-popup"),j=_("van-dialog");return d(),c("div",Ge,[r(i,{title:"ArUpiPay",placeholder:!1,"left-arrow":"",onClickLeft:L},{right:p(()=>[e("div",{class:"sever x-row x-row-between x-row-middle-center",onClick:a[0]||(a[0]=(...n)=>m(M)&&m(M)(...n))},o(t.$t("customerService")),1)]),_:1}),s.type===0?(d(),c("div",je,[e("div",Xe,[e("div",Ye,[e("span",et,[w(o(m(ae)(s.info.amount||0))+" ",1),e("div",tt,[r(l,{onClick:a[1]||(a[1]=n=>m(F)(s.info.amount)),name:"copy"})])]),e("div",at,[w(o(t.$t("remainingTime"))+" ",1),e("span",null,o(m(oe)(s.info.paymentExpireTime||0)),1)])])]),y.value!=="Paytm"?(d(),c("div",ot,[e("div",st,[nt,e("p",null,o(t.$t("choosePay")),1)]),e("div",it,[(d(!0),c(Y,null,ee(Z.value,(n,N)=>(d(),c("div",{class:E(["item",{active:y.value===n.name,[n.name]:!0}]),key:N,onClick:Xt=>n.name==="Paytm"?ye():J(n)},[e("div",rt,[e("img",{class:"img",src:m(Qe)(n.icon,"svg")},null,8,dt),e("p",ct,o(n.name),1)]),e("p",null,o(n.desc),1)],10,lt))),128))])])):f("v-if",!0),e("div",{class:E({order_active:y.value==="PhonePe"})},[y.value!=="Paytm"?(d(),c("div",ut,[e("div",pt,[mt,e("p",null,o(t.$t("scanPay")),1)]),e("div",vt,[e("div",null,[e("div",ft,[r(B,{src:m(ce),class:"qrc",id:"canvasDom"},{loading:p(()=>[r(v,{type:"spinner",size:"20"})]),_:1},8,["src"])]),ge.value?(d(),c("div",ht,[e("span",null,o(we(s.info.upiId)),1),r(l,{onClick:a[2]||(a[2]=n=>m(F)(s.info.upiId)),name:"copy",class:"copy-icon"})])):f("v-if",!0),e("h3",yt,"1."+o(t.$t("scanPayTip")),1),e("p",_t," 2."+o(t.$t("deviceQR"))+". ",1)])]),e("div",wt,[gt,e("p",null,o(t.$t("inputUTR")),1)])])):f("v-if",!0),e("div",kt,[e("p",null,o(t.$t("fillUTR"))+".",1),e("div",Ct,[r(G,{modelValue:u.value,"onUpdate:modelValue":a[3]||(a[3]=n=>u.value=n),maxlength:12,disabled:!!T.value,type:"digit",autocomplete:"new-password",placeholder:t.$t("inputDigits"),class:"inp"},{button:p(()=>[r(D,{size:"small",type:"primary",onClick:z},{default:p(()=>[w(o(t.$t("paste")),1)]),_:1})]),_:1},8,["modelValue","disabled","placeholder"]),f(' <div class="copy" @click="submit">Submit</div> ')])])],2),e("div",bt,[$t,e("p",null,o(t.$t("importantReminder"))+"：",1)]),e("div",Tt,[e("p",null,"1."+o(t.$t("sameLink")),1),e("p",null,"2."+o(t.$t("paytmUp")),1)])])):f("v-if",!0),s.type===4?(d(),c("div",Pt,[e("div",xt,[e("div",St,[e("span",It,[w(o(m(ae)(s.info.amount||0))+" ",1),e("div",Ut,[r(l,{onClick:a[4]||(a[4]=n=>m(F)(s.info.amount)),name:"copy"})])]),e("div",Lt,[w(o(t.$t("remainingTime"))+" ",1),e("span",null,o(m(oe)(s.info.paymentExpireTime||0)),1)])])]),e("div",Dt,[e("p",null,o(t.$t("fillUTR"))+".",1),e("div",Nt,[r(G,{modelValue:u.value,"onUpdate:modelValue":a[5]||(a[5]=n=>u.value=n),maxlength:12,disabled:!!T.value,type:"digit",autocomplete:"new-password",placeholder:t.$t("inputDigits"),class:"inp"},{button:p(()=>[r(D,{size:"small",type:"primary",onClick:z},{default:p(()=>[w(o(t.$t("paste")),1)]),_:1})]),_:1},8,["modelValue","disabled","placeholder"]),f(' <div class="copy" @click="submit">Submit</div> ')])])])):f("v-if",!0),f(" 取消和提交 "),[0,4].includes(s.type)&&!T.value?(d(),c("div",Vt,[s.type==0?(d(),c("div",{key:0,class:"cancel",onClick:a[6]||(a[6]=()=>{if(y.value){y.value="";return}$.value=!0})},o(y.value==="Paytm"?t.$t("withdrawDialogDesc6"):t.$t("cancel")),1)):(d(),c("div",{key:1,class:"cancel",onClick:a[7]||(a[7]=()=>{if(s.type==4&&(s.type=0,t.reruen),y.value){y.value="";return}})},o(s.type==4?t.$t("withdrawDialogDesc6"):t.$t("cancel")),1)),e("div",{class:E(["submit",T.value||u.value?"active":""]),onClick:a[8]||(a[8]=(...n)=>m(K)&&m(K)(...n))},o(t.$t("submit"))+" "+o(u.value?"":t.$t("unSubmitUtr")),3)])):f("v-if",!0),s.type==1?(d(),c("div",Rt,[Bt,e("p",Et,o(t.$t("PaymentExpired")),1),r(D,{round:"",block:"",type:"primary",class:"x-btn btn mt40",onClick:L},{default:p(()=>[w(o(t.$t("returnMerchant")),1)]),_:1})])):f("v-if",!0),s.type==3?(d(),c("div",Ot,[Ft,e("p",Mt,o(t.$t("submitSuccessfully")),1),e("p",null,o(t.$t("untilConfirm")),1),r(D,{round:"",block:"",type:"primary",class:"x-btn btn mt40",onClick:L},{default:p(()=>[w(o(t.$t("complete")),1)]),_:1})])):f("v-if",!0),r(be,{position:"bottom",show:C.value,"onUpdate:show":a[11]||(a[11]=n=>C.value=n)},{default:p(()=>[e("div",At,[e("div",qt,o(t.$t("cancelOrder")),1),r(Ce,{"icon-size":"16px",modelValue:h.checked,"onUpdate:modelValue":a[9]||(a[9]=n=>h.checked=n),"checked-color":"#EE4D4D",onChange:de},{default:p(()=>[(d(!0),c(Y,null,ee(U.value,(n,N)=>(d(),Ee(ke,{name:N,class:"item",key:N},{default:p(()=>[w(o(n.reason),1)]),_:2},1032,["name"]))),128)),f(` <van-radio name="2" class="item">UPI账号错误</van-radio>\r
                            <van-radio name="3" class="item">银行系统维护</van-radio>\r
                            <van-radio name="4" class="item">其他</van-radio> `)]),_:1},8,["modelValue"]),e("div",Wt,[Oe(e("textarea",{class:"row","onUpdate:modelValue":a[10]||(a[10]=n=>h.text=n),rows:"4",placeholder:t.$t("sellTip18"),onInput:re},null,40,zt),[[Fe,h.text]])]),e("div",{class:"btn x-row x-row-middle-center",onClick:_e},o(t.$t("confirmCancel")),1)])]),_:1},8,["show"]),r(j,{class:"arupi-dialog",closeOnClickOverlay:!1,show:I.value,"onUpdate:show":a[12]||(a[12]=n=>I.value=n),"show-confirm-button":!1,width:327},{default:p(()=>[e("div",Zt,[e("div",Qt,o(t.$t("tips")),1),e("div",Ht,o(t.$t("safetyTip")),1),e("p",null,o(R.value)+"S",1)])]),_:1},8,["show"]),r(j,{class:"arupi-dialog",closeOnClickOverlay:!1,show:$.value,"onUpdate:show":a[15]||(a[15]=n=>$.value=n),"show-confirm-button":!1,width:327},{default:p(()=>[e("div",Jt,[e("div",Kt,o(t.$t("cancelDeal")),1),e("div",Gt,o(t.$t("paymeConfirm")),1),e("div",jt,[e("div",{class:"clance",onClick:a[13]||(a[13]=()=>{h.checked=-1,h.text="",C.value=!0,$.value=!1})},o(t.$t("confirmCancel")),1),e("div",{class:"goBuy",onClick:a[14]||(a[14]=n=>fe())},o(t.$t("payme")),1)])])]),_:1},8,["show"])])}}});export{aa as _};
