import{G as ie,z as _e,r as g,R as le,B as j,$ as oe,C as ue,aJ as de,H as L,I as M,Q as _,J as s,O as d,P as v,an as N,at as fe,aw as x,ax as W,aE as he,au as ce,b1 as be,u as f,F as we,V as X,aB as ye,aC as Se,N as D,aA as ke,aY as Ie,al as Ce,n as Ve,ao as Q}from"./common.modules-6670d68a.js";import{d as Oe,V as qe,P as ee,v as Y,S as Re,E as xe,b as Le,c as me,e as Ge}from"./page-login-index.vue_vue_type_script_setup_true_lang.ts-40ced6ac.js";import{y as He,a3 as ve,cs as te,a4 as je,ct as Te,b$ as pe,A as J,bg as Je,bh as Pe,aM as De,G as ge,cu as Fe,bk as $e,b8 as Be,_ as Ee,bm as Ke,n as ze,cv as Ze}from"./page-activity-ActivityDetail-88cfafe3.js";const Qe=S=>(ye("data-v-e26f70e7"),S=S(),Se(),S),Ye=["onKeydown"],We={class:"tip"},Xe={key:0,class:"red"},et={key:1,class:"red"},tt={class:"register__container-tip"},at=Qe(()=>s("div",{class:"tipbg"},null,-1)),st={class:"register__container-tips"},rt={class:"register__container-invitation"},nt={class:"register__container-invitation__label"},ot={class:"register__container-invitation__input"},it=["placeholder","disabled"],lt={class:"register__container-remember"},ut={class:"register__container-button"},dt={class:"account"},ct={class:"loginin"},vt=ie({__name:"Register",props:{registerData:{type:Object,required:!0}},emits:["submit"],setup(S,{expose:G,emit:H}){const R=S,{t:e}=_e(),b=He(),o=ve(),n=g(!1),t=g({number:"",numberType:o.rPwdForm.numberType,smsvcode:"",password:"",rePassword:"",invitecode:"",registerType:"mobile",packId:te.getPackId()||""}),F=g("register");t.value.number="",sessionStorage.getItem("register_a")&&(t.value=JSON.parse(sessionStorage.getItem("register_a")||""),sessionStorage.setItem("register_a",""));const T=le(),k=g(!1),w=g(!1),U=g({}),i=j(()=>{var a,r,p,h,u;return!!((r=(a=U.value)==null?void 0:a.apkInfo)!=null&&r.invitationCode||(p=T.currentRoute.value.query)!=null&&p.invitationCode||(u=(h=T.currentRoute.value.query)==null?void 0:h.r_code)!=null&&u.toString()||sessionStorage.getItem("invitecode"))}),m=j(()=>R.registerData.isInvitecode=="1"?e("plsEnterInvitationCode"):e("notNecessary")),y=b.isOpenRegisterPhoneFirstZeroSwitch;oe(()=>t.value.number,a=>{o.setCountDown(0)},{flush:"post"}),oe(()=>o.rPwdForm.numberType,a=>{!t.value.numberType&&(t.value.numberType=a)},{flush:"post"});function $(){T.push({name:"login"})}const B=async()=>{if(!pe(t.value.numberType,t.value.number.trim().length))return o.setCountDown(0),f({message:e("wrongTel"),wordBreak:"break-word"});await J(Je({phone:t.value.numberType.replace("+","")+t.value.number,codeType:Pe.Registr}))?we(e("sendSuccess")):setTimeout(()=>{o.setCountDown(0)},500)};j(()=>{var h;let a=e("regTip2").match(/\d+/);""+t.value.numberType;const r=(h=b.getAreaPhoneLenList.find(u=>(u==null?void 0:u.area)=="+"+t.value.numberType))==null?void 0:h.len;let p=9;return(r==null?void 0:r.indexOf("-"))!=-1?p=r==null?void 0:r.toString().split("-")[0]:p=r,a?a[0].substr(0,p):""});const q=a=>{const r=a.target;r.value=r.value.replace(/[\s\n\t\r]/g,"")},V=async()=>{if(!pe(t.value.numberType,t.value.number.trim().length))return f({message:e("wrongTel"),wordBreak:"break-word"});if(t.value.number.charAt(0)==="0"&&b.isOpenRegisterPhoneFirstZeroSwitch)return f({message:e("registerNumberTip"),wordBreak:"break-word"});if(R.registerData.registerMobileState!=="1")return f({message:e("registerClose"),wordBreak:"break-word"});if(!t.value.number.trim()||k.value){k.value=!0;return}if(R.registerData.isOpenRegisterSMS!=="0")if(t.value.smsvcode.trim()){if(t.value.smsvcode.trim().length!=6)return f({message:e("verifyCode6Digits"),wordBreak:"break-word"})}else return f({message:e("registerTip1"),wordBreak:"break-word"});if(!t.value.password.trim())return f({message:e("registerTip2"),wordBreak:"break-word"});if(!Y.passReg3.test(t.value.password)){n.value=!0;return}if(!t.value.rePassword.trim())return f({message:e("registerTip3"),wordBreak:"break-word"});if(t.value.rePassword!==t.value.password){w.value=!0;return}else w.value=!1;if(!o.userForm.termAndPolicy)return f({message:e("registerDesc1"),wordBreak:"break-word"});R.registerData.hasRegisterCaptcha==="1"?A():I("")},P=a=>{t.value.numberType=a},O=a=>{t.value.number=a},K=()=>{Ce("toPath","ResetPassword"),T.push({name:"About-AboutDetail"})},E=g(),c=g(""),{setLoading:l}=je(),I=async a=>{X(async()=>{l(!0),E.value.startRequestVerify();const{number:r,numberType:p,smsvcode:h,password:u,invitecode:z,packId:ae}=t.value;let se={username:p.replace("+","")+r,smsvcode:h,registerType:t.value.registerType,pwd:u,invitecode:z,packId:ae,domainurl:window.location.hostname,phonetype:De(),captchaId:c.value,track:a,deviceId:localStorage.getItem("arvId")||te.getDeviceId()};o.register(se).then(async C=>{var Z;if(C){l(!1);const Ae=ge(),{token:re,tokenHeader:Me,parentUserId:Ne}=C==null?void 0:C.data;Ae.setToken(re),localStorage.setItem("tokenHeader",Me),localStorage.setItem("numberType",o.getUserForm.numberType),localStorage.setItem("number",o.userForm.number),H("submit"),T.replace("/"),await o.getUserInfo({signature:re});const ne=await o.getUserInfo({signature:re});Fe("prediction","userId",[Ne]);const{onTriggerRegister:Ue}=Be();Ue((Z=ne==null?void 0:ne.data)==null?void 0:Z.userId)}}).catch(C=>{}).finally(()=>{var C;l(!1),(C=E.value)==null||C.setShowHiden(!1)})})},A=async()=>{X(async()=>{E.value.startRequestGenerate();const a=await J($e());a?(c.value=a.data.captchaId,E.value.endRequestGenerate(a.data.backgroundImage,a.data.sliderImage)):E.value.endRequestGenerate(null,null)})};return ue(async()=>{var r,p,h,u;o.setCountDown(0),U.value=await Te(["apkInfo"]);const a=((p=(r=U.value)==null?void 0:r.apkInfo)==null?void 0:p.invitationCode)||((h=T.currentRoute.value.query.invitationCode)==null?void 0:h.toString())||((u=T.currentRoute.value.query.r_code)==null?void 0:u.toString())||sessionStorage.getItem("invitecode")||"";a&&(t.value.invitecode=a,sessionStorage.setItem("invitecode",a)),o.getIp()}),de((a,r)=>{a.name=="About-AboutDetail"?sessionStorage.setItem("register_a",JSON.stringify(t.value)):sessionStorage.setItem("register_a","")}),G({showPhoneValidate:k}),(a,r)=>{const p=L("svg-icon"),h=L("van-checkbox");return D(),M("div",{class:"register__container",onKeydown:be(V,["enter"])},[_(Oe,{"show-validate":k.value,"onUpdate:showValidate":r[0]||(r[0]=u=>k.value=u),number:t.value.number,"onUpdate:number":r[1]||(r[1]=u=>t.value.number=u),"number-type":t.value.numberType,type:F.value,onChangeT:P,onChangeN:O,typeP:"register"},null,8,["show-validate","number","number-type","type"]),s("div",We,[d(y)?(D(),M("span",Xe,v(d(e)("regTip1")),1)):N("v-if",!0),d(y)?(D(),M("p",et,v(d(e)("regTip2")),1)):N("v-if",!0),N("{{ truncateNumber }} ")]),a.registerData.isOpenRegisterSMS!=="0"?(D(),fe(qe,{key:0,value:t.value.smsvcode,"onUpdate:value":r[2]||(r[2]=u=>t.value.smsvcode=u),sendFunc:B,number:t.value.number,numberType:t.value.numberType},null,8,["value","number","numberType"])):N("v-if",!0),_(ee,{value:t.value.password,"onUpdate:value":r[3]||(r[3]=u=>t.value.password=u),label:d(e)("setPsw")},null,8,["value","label"]),x(s("div",tt,[at,s("span",null,v(d(e)("pswRule")),1)],512),[[W,n.value]]),_(ee,{value:t.value.rePassword,"onUpdate:value":r[4]||(r[4]=u=>t.value.rePassword=u),label:d(e)("comfirmPsw")},null,8,["value","label"]),x(s("div",st,[s("span",null,v(d(e)("unmatchedInput")),1)],512),[[W,w.value]]),s("div",rt,[s("div",nt,[_(p,{name:"invitation"}),s("span",null,v(d(e)("invitationCode")),1)]),s("div",ot,[x(s("input",{type:"text","auto-complete":"new-password",autocomplete:"off",name:"userNumber","onUpdate:modelValue":r[5]||(r[5]=u=>t.value.invitecode=u),placeholder:m.value,disabled:i.value,maxlength:"20",onInput:q},null,40,it),[[he,t.value.invitecode,void 0,{trim:!0}]])])]),s("div",lt,[_(h,{modelValue:d(o).userForm.termAndPolicy,"onUpdate:modelValue":r[7]||(r[7]=u=>d(o).userForm.termAndPolicy=u)},{default:ce(()=>[ke(v(d(e)("readNagree"))+" ",1),s("span",{onClick:r[6]||(r[6]=Ie(u=>K(),["stop"]))},v(d(e)("desPrivacy")),1)]),_:1},8,["modelValue"])]),s("div",ut,[s("button",{onClick:V},v(d(e)("register")),1),s("button",{class:"login",onClick:$},[s("div",dt,v(d(e)("iHaveAcount")),1),s("div",ct,v(d(e)("goLogin")),1)])]),_(Re,{ref_key:"captchaRef",ref:E,"refresh-color":"#FFFFFF","show-refresh":!0,onFinish:I,onRefresh:A},null,512)],40,Ye)}}});const gt=Ee(vt,[["__scopeId","data-v-e26f70e7"],["__file","/Users/juneqiu/Desktop/june/project/ar_v2_vue/src/components/Login/Register.vue"]]),mt=S=>(ye("data-v-1679e191"),S=S(),Se(),S),pt=["onKeydown"],_t={class:"register__container-tip"},ft=mt(()=>s("div",{class:"tipbg"},null,-1)),ht={class:"register__container-tips"},bt={class:"register__container-invitation"},wt={class:"register__container-invitation__label"},yt={class:"register__container-invitation__input"},St=["placeholder","disabled"],kt={class:"register__container-remember"},It={class:"register__container-button"},Ct={class:"account"},Rt={class:"loginin"},Tt=ie({__name:"EmailRegister",props:{registerData:{type:Object,required:!0}},emits:["submit"],setup(S,{expose:G,emit:H}){const R=S,{t:e}=_e(),b=g(!1),o=ve(),n=g({smsvcode:"",password:"",rePassword:"",invitecode:"",email:"",registerType:"email",packId:te.getPackId()||""}),t=g("register");sessionStorage.getItem("register")&&(n.value=JSON.parse(sessionStorage.getItem("register")||""),sessionStorage.setItem("register",""));const F=le(),T=g(!1),k=g(!1),w=g({}),U=j(()=>{var c,l,I;return!!((l=(c=w.value)==null?void 0:c.apkInfo)!=null&&l.invitationCode||(I=F.currentRoute.value.query)!=null&&I.invitationCode)}),i=j(()=>R.registerData.isInvitecode=="1"?e("plsEnterInvitationCode"):e("notNecessary"));oe(()=>n.value.email,c=>{o.setCountDown(0)},{flush:"post"});function m(){F.push({name:"login"})}const y=async()=>{if(!Y.email1.test(n.value.email))return o.setCountEmailDown(0),f({message:e(me.email),wordBreak:"break-word"});await J(Ke({email:n.value.email,emailType:Pe.Registr}))?we(e("sendSuccess")):o.setCountEmailDown(0)},$=c=>{const l=c.target;l.value=l.value.replace(/[\s\n\t\r]/g,"")},B=async()=>{if(R.registerData.registerEmailState!=="1")return f({message:e("registerClose"),wordBreak:"break-word"});if(R.registerData.isOpenRegisterEmail!=="0")if(n.value.smsvcode.trim()){if(n.value.smsvcode.trim().length!=6)return f({message:e("verifyCode6Digits"),wordBreak:"break-word"})}else return f({message:e("registerTip6"),wordBreak:"break-word"});if(!Y.email1.test(n.value.email))return f({message:e(me.email),wordBreak:"break-word"});if(!n.value.password.trim())return f({message:e("registerTip2"),wordBreak:"break-word"});if(!Y.passReg3.test(n.value.password)){b.value=!0;return}if(!n.value.rePassword.trim())return f({message:e("registerTip3"),wordBreak:"break-word"});if(n.value.rePassword!==n.value.password){k.value=!0;return}else k.value=!1;if(!o.userForm.termAndPolicy)return f({message:e("registerDesc1"),wordBreak:"break-word"});R.registerData.hasRegisterCaptcha==="1"?E():K("")},q=c=>{n.value.email=c},V=()=>{Ce("toPath","ResetPassword"),F.push({name:"About-AboutDetail"})},P=g(),O=g(""),K=async c=>{X(async()=>{P.value.startRequestVerify();const{smsvcode:l,password:I,invitecode:A,packId:a}=n.value;let r={username:n.value.email,smsvcode:l,registerType:n.value.registerType,pwd:I,invitecode:A,domainurl:window.location.hostname,phonetype:De(),captchaId:O.value,track:c,deviceId:localStorage.getItem("arvId")||te.getDeviceId(),packId:a};o.register(r).then(async p=>{var h;if(p){const u=ge(),{token:z,tokenHeader:ae,parentUserId:se}=p==null?void 0:p.data;u.setToken(z),localStorage.setItem("tokenHeader",ae),localStorage.setItem("numberType",o.getUserForm.numberType),localStorage.setItem("number",o.userForm.number),H("submit"),F.replace("/");const C=await o.getUserInfo({signature:z});Fe("prediction","userId",[se||""]);const{onTriggerRegister:Z}=Be();Z((h=C==null?void 0:C.data)==null?void 0:h.userId)}}).catch(p=>{}).finally(()=>{P.value.setShowHiden(!1)})})},E=async()=>{X(async()=>{P.value.startRequestGenerate();const c=await J($e());c?(O.value=c.data.captchaId,P.value.endRequestGenerate(c.data.backgroundImage,c.data.sliderImage)):P.value.endRequestGenerate(null,null)})};return ue(async()=>{var l,I,A,a;o.setCountEmailDown(0),w.value=await Te(["apkInfo"]);const c=((I=(l=w.value)==null?void 0:l.apkInfo)==null?void 0:I.invitationCode)||((A=F.currentRoute.value.query.invitationCode)==null?void 0:A.toString())||((a=F.currentRoute.value.query.r_code)==null?void 0:a.toString())||sessionStorage.getItem("invitecode")||"";c&&(n.value.invitecode=c)}),de((c,l)=>{c.name=="About-AboutDetail"?sessionStorage.setItem("register",JSON.stringify(n.value)):sessionStorage.setItem("register","")}),G({showPhoneValidate:T}),(c,l)=>{const I=L("svg-icon"),A=L("van-checkbox");return D(),M("div",{class:"register__container",onKeydown:be(B,["enter"])},[_(xe,{ref:"email",type:t.value,email:n.value.email,onChangeN:q},null,8,["type","email"]),c.registerData.isOpenRegisterEmail!=="0"?(D(),fe(Le,{key:0,value:n.value.smsvcode,"onUpdate:value":l[0]||(l[0]=a=>n.value.smsvcode=a),sendFunc:y,email:n.value.email},null,8,["value","email"])):N("v-if",!0),_(ee,{value:n.value.password,"onUpdate:value":l[1]||(l[1]=a=>n.value.password=a),label:d(e)("setPsw")},null,8,["value","label"]),x(s("div",_t,[ft,s("span",null,v(d(e)("pswRule")),1)],512),[[W,b.value]]),_(ee,{value:n.value.rePassword,"onUpdate:value":l[2]||(l[2]=a=>n.value.rePassword=a),label:d(e)("comfirmPsw")},null,8,["value","label"]),x(s("div",ht,[s("span",null,v(d(e)("unmatchedInput")),1)],512),[[W,k.value]]),s("div",bt,[s("div",wt,[_(I,{name:"invitation"}),s("span",null,v(d(e)("invitationCode")),1)]),s("div",yt,[x(s("input",{type:"text","auto-complete":"new-password",autocomplete:"off",name:"userNumber","onUpdate:modelValue":l[3]||(l[3]=a=>n.value.invitecode=a),placeholder:i.value,disabled:U.value,maxlength:"20",onInput:$},null,40,St),[[he,n.value.invitecode,void 0,{trim:!0}]])])]),s("div",kt,[_(A,{modelValue:d(o).userForm.termAndPolicy,"onUpdate:modelValue":l[5]||(l[5]=a=>d(o).userForm.termAndPolicy=a)},{default:ce(()=>[ke(v(d(e)("readNagree"))+" ",1),s("span",{onClick:l[4]||(l[4]=Ie(a=>V(),["stop"]))},v(d(e)("desPrivacy")),1)]),_:1},8,["modelValue"])]),s("div",It,[s("button",{onClick:B},v(d(e)("register")),1),s("button",{class:"login",onClick:m},[s("div",Ct,v(d(e)("iHaveAcount")),1),s("div",Rt,v(d(e)("goLogin")),1)])]),_(Re,{ref_key:"captchaRef",ref:P,"refresh-color":"#FFFFFF","show-refresh":!0,onFinish:K,onRefresh:E},null,512)],40,pt)}}});const Pt=Ee(Tt,[["__scopeId","data-v-1679e191"],["__file","/Users/juneqiu/Desktop/june/project/ar_v2_vue/src/components/Login/EmailRegister.vue"]]),Dt={class:"resgister__C"},Ft={class:"resgister__C-heading"},$t={class:"resgister__C-heading__title"},Bt={class:"resgister__C-heading__subTitle"},Et={class:"login_container-tab"},At={class:"resgister__C-form"},Vt=ie({__name:"index",setup(S){const{openAll:G}=ze(),H=ge(),R=ve();g("");const e=g({isRegisterState:"1",SMSstate:"0",registerStateMsg:"",hasRegisterCaptcha:"0",registerEmailState:"0",registerMobileState:"0",isOpenRegisterSMS:"0",isOpenRegisterEmail:"0",isInvitecode:"0"}),b=g("phone"),o=le();H.token&&o.push({name:"home"});const n=i=>{b.value=i};de((i,m,y)=>{y(),i.name==="home"&&G()});const t=g();function F(){o.push({name:"home"})}async function T(){var m,y,$,B,q,V,P,O;const i=await J(Ze());i&&(e.value.isRegisterState=i.data.registerState,e.value.registerStateMsg=i.data.registerStateMsg,e.value.registerEmailState=i.data.registerEmailState,e.value.registerMobileState=(m=i.data)==null?void 0:m.registerMobileState,e.value.isOpenRegisterSMS=(y=i.data)==null?void 0:y.isOpenRegisterSMS,e.value.isOpenRegisterEmail=($=i.data)==null?void 0:$.isOpenRegisterEmail,e.value.hasRegisterCaptcha=i.data.isOpenRegisterCaptcha,e.value.isInvitecode=(B=i.data)==null?void 0:B.isInvitecode,R.setTermAndPolicy(((q=i.data)==null?void 0:q.registerPrivacyChecked)==="1"),Number(i.data.registerEmailState)+Number((V=i.data)==null?void 0:V.registerMobileState)==0?(((P=i.data)==null?void 0:P.isOpenRegisterSMS)!=="1"&&(b.value="email"),o.push({name:"login"})):(e.value.registerSMSState=i.data.registerSMSState,e.value.registerEmailState!=="0"&&((O=i.data)==null?void 0:O.registerMobileState)=="0"&&(b.value="email")))}T();function k(){const m=window.location.hash.match(/invitationCode=([\d]+)/);return m?m[1]:null}const w=g(null),U=()=>{w.value&&window.gtag&&window.gtag("event","register_button_click",{invitation_code:w.value})};return k(),ue(async()=>{w.value=k(),w.value&&(window.gtag?window.gtag("event","page_view_with_invitation",{invitation_code:w.value}):console.warn("Google Analytics 未初始化，无法发送事件"));const{default:i}=await Ve(()=>import("./chunk.fingerprintjs-3fa79c76.js"),["assets/js/chunk.fingerprintjs-3fa79c76.js","assets/js/common.modules-6670d68a.js","assets/css/common-e210f711.css"]);localStorage.getItem("arvId")||i.load().then(m=>{m.get().then(y=>{localStorage.setItem("arvId",y.visitorId)})}).catch(m=>{console.error("Error generating fingerprint:",m)})}),(i,m)=>{const y=L("NavBar"),$=L("svg-icon");return D(),M("div",Dt,[_(y,{onClickLeft:F,leftArrow:!0,headLogo:!0,class:"main"},{right:ce(()=>[_(Ge)]),_:1}),s("div",Ft,[s("h1",$t,v(i.$t("register")),1),s("div",Bt,[s("span",null,v(i.$t("registerbyphoneoremail")),1)])]),s("div",Et,[e.value.registerMobileState!="0"?(D(),M("div",{key:0,class:Q(["tab",[b.value=="phone"?"active":""]]),onClick:m[0]||(m[0]=B=>n("phone"))},[_($,{name:"phone"}),s("div",null,v(i.$t("phoneregister")),1)],2)):N("v-if",!0),e.value.registerEmailState!="0"?(D(),M("div",{key:1,class:Q(["tab",[b.value=="email"?"active":""]]),onClick:m[1]||(m[1]=B=>n("email"))},[_($,{name:"email"}),s("div",null,v(i.$t("emailregister")),1)],2)):N("v-if",!0)]),s("div",At,[e.value.registerMobileState!="0"?(D(),M("div",{key:0,class:Q(["tab-content",[b.value=="phone"?"activecontent":""]])},[_(gt,{ref_key:"register",ref:t,registerData:e.value,onSubmit:U},null,8,["registerData"])],2)):N("v-if",!0),e.value.registerEmailState!="0"?(D(),M("div",{key:1,class:Q(["tab-content",[b.value=="email"?"activecontent":""]])},[_(Pt,{ref_key:"register",ref:t,registerData:e.value,onSubmit:U},null,8,["registerData"])],2)):N("v-if",!0)])])}}});export{Vt as _};
